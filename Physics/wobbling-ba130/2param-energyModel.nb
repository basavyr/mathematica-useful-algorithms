(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7014,        209]
NotebookOptionsPosition[      5782,        179]
NotebookOutlinePosition[      6178,        195]
CellTagsIndexPosition[      6135,        192]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Fitting the rotor energy with two parameters", "Chapter",
 CellChangeTimes->{{3.859388343051947*^9, 
  3.859388353829359*^9}},ExpressionUUID->"e6b5f72d-b41d-4d86-bd6e-\
3026644b6f65"],

Cell[CellGroupData[{

Cell["Using the wobbling frequency and the largest moi", "Subsection",
 CellChangeTimes->{{3.85938835540065*^9, 
  3.859388367280094*^9}},ExpressionUUID->"94b04b1e-5678-441b-a29b-\
050c5eefa375"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"energy", "[", 
    RowBox[{"n_", ",", "I_", ",", "moi3_", ",", "omega_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "*", "moi3"}]], "I", 
     RowBox[{"(", 
      RowBox[{"I", "+", "1"}], ")"}]}], "+", 
    RowBox[{"omega", "*", 
     RowBox[{"(", 
      RowBox[{"n", "+", 
       FractionBox["1", "2"]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.85938836903658*^9, 3.859388403029685*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"cd46dd86-917c-4522-8fbb-432653eb85ee"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testband1", "[", 
    RowBox[{"p1_", ",", "p2_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"energy", "[", 
      RowBox[{"0", ",", "x", ",", "p1", ",", "p2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "10", ",", "28", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testband2", "[", 
    RowBox[{"p1_", ",", "p2_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"energy", "[", 
      RowBox[{"1", ",", "x", ",", "p1", ",", "p2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "11", ",", "25", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{"testband1", "[", 
   RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{"testband2", "[", 
   RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8593884098798923`*^9, 3.859388529056477*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"3075d1cc-f69e-4736-8d44-b97bd1a630ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "55.5`", ",", "78.5`", ",", "105.5`", ",", "136.5`", ",", "171.5`", ",", 
   "210.5`", ",", "253.5`", ",", "300.5`", ",", "351.5`", ",", "406.5`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.859388448876882*^9, 3.859388452692914*^9}, {
  3.8593885222622337`*^9, 3.8593885295195217`*^9}},
 CellLabel->"Out[95]=",ExpressionUUID->"b60e552a-1085-40dd-9fde-d60a69de5adf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "67.5`", ",", "92.5`", ",", "121.5`", ",", "154.5`", ",", "191.5`", ",", 
   "232.5`", ",", "277.5`", ",", "326.5`"}], "}"}]], "Output",
 CellChangeTimes->{{3.859388448876882*^9, 3.859388452692914*^9}, {
  3.8593885222622337`*^9, 3.859388529521144*^9}},
 CellLabel->"Out[96]=",ExpressionUUID->"a91d939f-3f45-4fcc-8dd9-ae775483c972"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expdata1", "=", 
   RowBox[{"{", 
    RowBox[{
    "3790.3", ",", "4256.3", ",", "4884.2", ",", "5678.3", ",", "6563.3", ",",
      "7524.3", ",", "8574.3", ",", "9690.3", ",", "10821.3", ",", 
     "11984.3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expdata1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "/", "1000"}], ")"}], "&"}], "/@", "expdata1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spins1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "10", ",", "28", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spins1", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"expdata1", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "expdata1", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.85938982985588*^9, 3.859389830778178*^9}, {
  3.859389891091832*^9, 3.8593900232732887`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"c765947d-28fe-4c28-9baf-b1cadc43868a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nlm", "=", 
   RowBox[{"NonlinearModelFit", "[", 
    RowBox[{"data1", ",", 
     RowBox[{"energy", "[", 
      RowBox[{"0", ",", "x", ",", "p1", ",", "p2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2"}], "}"}], ",", 
     RowBox[{"{", "x", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", "params"}], "Input",
 CellChangeTimes->{{3.85939004441604*^9, 3.859390093128224*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"7ba4cca5-cdb6-40c0-b971-126186330031"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"p1", "\[Rule]", "42.03547924233234`"}], ",", 
   RowBox[{"p2", "\[Rule]", "4.928346303798363`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8593900932920437`*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"21b3da73-68c0-4afa-9ba7-972a09d34ef1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 897},
WindowMargins->{{12, Automatic}, {Automatic, 24}},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"058eccc4-c49d-4cba-bbf5-340b5961517e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 189, 3, 69, "Chapter",ExpressionUUID->"e6b5f72d-b41d-4d86-bd6e-3026644b6f65"],
Cell[CellGroupData[{
Cell[794, 29, 195, 3, 54, "Subsection",ExpressionUUID->"94b04b1e-5678-441b-a29b-050c5eefa375"],
Cell[992, 34, 566, 16, 48, "Input",ExpressionUUID->"cd46dd86-917c-4522-8fbb-432653eb85ee"],
Cell[CellGroupData[{
Cell[1583, 54, 1090, 30, 94, "Input",ExpressionUUID->"3075d1cc-f69e-4736-8d44-b97bd1a630ae"],
Cell[2676, 86, 409, 8, 34, "Output",ExpressionUUID->"b60e552a-1085-40dd-9fde-d60a69de5adf"],
Cell[3088, 96, 374, 7, 34, "Output",ExpressionUUID->"a91d939f-3f45-4fcc-8dd9-ae775483c972"]
}, Open  ]],
Cell[3477, 106, 1298, 39, 115, "Input",ExpressionUUID->"c765947d-28fe-4c28-9baf-b1cadc43868a"],
Cell[CellGroupData[{
Cell[4800, 149, 643, 16, 73, "Input",ExpressionUUID->"7ba4cca5-cdb6-40c0-b971-126186330031"],
Cell[5446, 167, 296, 7, 34, "Output",ExpressionUUID->"21b3da73-68c0-4afa-9ba7-972a09d34ef1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

